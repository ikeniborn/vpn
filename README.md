# VLESS-Reality VPN Solution with Tunneling

A comprehensive deployment solution for setting up a VPN server using the VLESS protocol with Reality encryption, including advanced two-server tunnel configuration with Outline VPN integration.

## Features

- **VLESS Protocol**: Lightweight and efficient VPN protocol
- **Reality Encryption**: Advanced security without certificates
- **Traffic Obfuscation**: Mimics legitimate TLS traffic to approved destinations
- **User Management**: Easy-to-use scripts for managing users
- **Security Hardening**: Built-in firewall and security checks
- **Docker-based**: Simple containerized deployment
- **Two-Server Tunnel**: Enhanced privacy with multi-hop architecture
- **Outline VPN Integration**: Client-friendly VPN interface

## System Requirements

### Server 1 (Tunnel Entry Point)
- **CPU**: 1+ cores
- **RAM**: 1GB+ recommended
- **Storage**: 10GB+ free space
- **Network**: Unrestricted outbound connections
- **Operating System**: Ubuntu 20.04+ or Debian 10+
- **Docker**: Required for container deployment

### Server 2 (Outline VPN Host)
- **CPU**: 2+ cores recommended
- **RAM**: 2GB+ recommended
- **Storage**: 20GB+ free space
- **Network**: Ability to reach Server 1
- **Operating System**: Ubuntu 20.04+ or Debian 10+
- **Docker**: Required for container deployment

## Quick Start

### Single Server Setup

For a basic single-server installation:

```bash
# Clone the repository
git clone https://github.com/yourusername/vpn.git
cd vpn

# Make scripts executable
chmod +x script/*.sh

# Run the all-in-one setup script
sudo ./script/setup-vless-reality-server.sh
```

### Two-Server Tunnel Setup

For the advanced two-server tunnel configuration:

1. **Setup Server 1 (Tunnel Entry Point)**:

```bash
# On Server 1
sudo ./script/setup-vless-server1.sh
```

2. **Save the connection details** generated by the script

3. **Setup Server 2 (Outline VPN Host)**:

```bash
# On Server 2, using the details from Server 1
sudo ./script/setup-vless-server2.sh \
  --server1-address <SERVER1_IP> \
  --server1-uuid <UUID_FROM_SERVER1>
```

4. **Configure Outline VPN** using the Outline Manager

## Installation Guide

For full installation instructions, follow the [comprehensive installation guide](docs/installation-guide.md) that explains the proper sequence for deploying all components.

## Documentation

### Architecture & Setup Guides

- [VLESS+Reality Tunnel Architecture](docs/vless-reality-tunnel-architecture.md): Overview of the two-server architecture
- [Server 1 Setup Guide](docs/server1-setup-guide.md): Configure the tunnel entry point
- [Server 2 Setup Guide](docs/server2-setup-guide.md): Configure the Outline VPN host
- [Outline VPN Installation](docs/outline-vpn-installation.md): Details on setting up Outline VPN
- [Tunnel Troubleshooting](docs/tunnel-troubleshooting.md): Diagnose and fix common issues

### Technical References

- [New Server Installation Guide](docs/vless-reality-new-server-guide.md): Single-server VLESS+Reality setup
- [WebSocket+TLS vs Reality Comparison](docs/websocket-tls-vs-reality.md): Technical protocol comparison

## Scripts

### Tunnel Configuration

- [setup-vless-server1.sh](script/setup-vless-server1.sh): Configure Server 1 (tunnel entry point)
- [setup-vless-server2.sh](script/setup-vless-server2.sh): Configure Server 2 (Outline VPN host)
- [tunnel-routing.conf](script/tunnel-routing.conf): Shared configuration for tunnel setup
- [test-tunnel-connection.sh](script/test-tunnel-connection.sh): Verify tunnel functionality
- [route-outline-through-tunnel.sh](script/route-outline-through-tunnel.sh): Configure existing Outline installations
- [uninstall-vless-tunnel.sh](script/uninstall-vless-tunnel.sh): Safely remove tunnel components

### Core VPN Scripts

- [setup-vless-reality-server.sh](script/setup-vless-reality-server.sh): All-in-one setup script for new servers
- [manage-vless-users.sh](script/manage-vless-users.sh): Add, remove, list, and export users
- [firewall.sh](script/firewall.sh): Configures firewall with secure defaults
- [security-checks-reality.sh](script/security-checks-reality.sh): Perform security audits

## User Management

### List Users

```bash
./script/manage-vless-users.sh --list
```

### Add User

```bash
./script/manage-vless-users.sh --add --name "user-phone"
```

### Remove User

```bash
./script/manage-vless-users.sh --remove --uuid "user-uuid"
```

### Export User Configuration

```bash
./script/manage-vless-users.sh --export --uuid "user-uuid"
```

## Testing & Verification

### Test Tunnel Connection

```bash
# On Server 1
sudo ./script/test-tunnel-connection.sh --server-type server1

# On Server 2
sudo ./script/test-tunnel-connection.sh --server-type server2 --server1-address <SERVER1_IP>
```

### Security Verification

Run a comprehensive security check:

```bash
sudo ./script/security-checks-reality.sh
```

## Security Considerations

- Use key-based SSH authentication and disable password login
- Keep all systems and Docker containers updated
- Configure firewall rules to only allow necessary traffic
- Regularly monitor logs for unusual activity
- Use strong, unique passwords for VPN access
- Consider implementing additional monitoring and intrusion detection
- Traffic separation enhances security through multiple server hops

## Compatible Clients

- **For VLESS+Reality**: v2rayN (Windows), v2rayNG (Android), Qv2ray (Cross-platform), V2Box (iOS), FoXray (macOS), Shadowrocket (iOS)
- **For Outline VPN**: Outline Client (Windows, macOS, Linux, Android, iOS, ChromeOS)

## Support and Contributions

Contributions are welcome! Please feel free to submit a Pull Request.

## License

This project is licensed under the Apache License 2.0 - see the LICENSE file for details.